<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Repositorios ‚Äî Fluxionics</title>
  <meta name="description" content="Todos los repositorios de GitHub de Guillermo Rafael S.M. ‚Äî Fluxionics.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#050810; --bg2:#080d1a; --surface:rgba(255,255,255,.03);
      --border:rgba(255,255,255,.07); --border-bright:rgba(0,230,200,.3);
      --accent:#00e6c8; --accent2:#4f8dff; --accent3:#ff5e8a;
      --text:#e8eaf2; --muted:#6b7a99;
      --fd:'Syne',sans-serif; --fm:'Space Mono',monospace; --fb:'Outfit',sans-serif;
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    html{scroll-behavior:smooth;}
    body{background:var(--bg);color:var(--text);font-family:var(--fb);overflow-x:hidden;}

    /* BG */
    .bg-grid{position:fixed;inset:0;z-index:0;pointer-events:none;
      background-image:linear-gradient(rgba(0,230,200,.025) 1px,transparent 1px),linear-gradient(90deg,rgba(0,230,200,.025) 1px,transparent 1px);
      background-size:60px 60px;}
    .bg-glow{position:fixed;inset:0;z-index:0;pointer-events:none;
      background:radial-gradient(ellipse 70% 50% at 10% 20%,rgba(0,230,200,.06) 0%,transparent 60%),
                radial-gradient(ellipse 50% 40% at 90% 70%,rgba(79,141,255,.06) 0%,transparent 60%);}

    /* NAV */
    nav{position:fixed;top:0;left:0;right:0;z-index:200;padding:0 5%;height:68px;
      display:flex;align-items:center;justify-content:space-between;
      background:rgba(5,8,16,.8);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
    .nav-logo{font-family:var(--fm);font-size:1rem;color:var(--accent);font-weight:700;text-decoration:none;}
    .nav-links{display:flex;gap:1.6rem;align-items:center;}
    .nav-links a{font-size:.82rem;color:var(--muted);text-decoration:none;font-weight:500;transition:color .2s;letter-spacing:.04em;}
    .nav-links a:hover,.nav-links a.active{color:var(--text);}
    .nav-cta{color:var(--accent)!important;border:1px solid rgba(0,230,200,.3);padding:.4rem 1rem;border-radius:6px;transition:background .2s,color .2s!important;}
    .nav-cta:hover{background:var(--accent)!important;color:#000!important;}
    .hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;background:none;border:none;padding:4px;}
    .hamburger span{width:22px;height:2px;background:var(--text);display:block;transition:all .3s;}

    .wrapper{position:relative;z-index:1;}
    .max-w{max-width:1100px;margin:0 auto;}

    /* PAGE HEADER */
    .page-header{padding:130px 5% 50px;text-align:center;}
    .section-label{font-family:var(--fm);font-size:.68rem;color:var(--accent);letter-spacing:.2em;text-transform:uppercase;margin-bottom:.7rem;}
    .page-title{font-family:var(--fd);font-size:clamp(2rem,5vw,3.8rem);font-weight:800;letter-spacing:-.03em;line-height:1.05;margin-bottom:.8rem;}
    .page-title span{background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
    .page-desc{font-size:.95rem;color:var(--muted);max-width:480px;margin:0 auto 2rem;line-height:1.7;font-weight:300;}

    /* GITHUB STATS BAR */
    .stats-bar{display:flex;gap:1.5rem;justify-content:center;flex-wrap:wrap;margin-bottom:1rem;}
    .stat-chip{display:flex;align-items:center;gap:.5rem;font-family:var(--fm);font-size:.72rem;color:var(--muted);
      background:var(--surface);border:1px solid var(--border);padding:.4rem 1rem;border-radius:8px;}
    .stat-chip strong{color:var(--accent);font-size:.9rem;}

    /* SECTION DIVIDERS */
    .section-block{padding:0 5% 60px;}
    .block-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem;}
    .block-title{font-family:var(--fd);font-weight:800;font-size:1.25rem;display:flex;align-items:center;gap:.6rem;}
    .block-title svg{color:var(--accent);}
    .block-link{font-family:var(--fm);font-size:.72rem;color:var(--accent);text-decoration:none;border-bottom:1px solid rgba(0,230,200,.3);padding-bottom:2px;transition:opacity .2s;}
    .block-link:hover{opacity:.7;}

    /* FEATURED REPOS ‚Äî big cards */
    .featured-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:1.25rem;margin-bottom:3.5rem;}
    .repo-featured{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:1.6rem;
      display:flex;flex-direction:column;gap:.9rem;cursor:pointer;
      transition:border-color .3s,transform .3s,box-shadow .3s;position:relative;overflow:hidden;}
    .repo-featured::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
      background:linear-gradient(90deg,var(--accent),var(--accent2));opacity:0;transition:opacity .3s;}
    .repo-featured:hover{border-color:var(--border-bright);transform:translateY(-5px);box-shadow:0 16px 50px rgba(0,230,200,.09);}
    .repo-featured:hover::before{opacity:1;}
    .repo-f-top{display:flex;justify-content:space-between;align-items:flex-start;gap:.8rem;}
    .repo-f-icon{font-size:1.6rem;line-height:1;}
    .repo-f-badge{font-family:var(--fm);font-size:.6rem;color:var(--accent);border:1px solid rgba(0,230,200,.3);
      background:rgba(0,230,200,.07);padding:.2rem .6rem;border-radius:4px;letter-spacing:.08em;white-space:nowrap;}
    .repo-f-name{font-family:var(--fd);font-weight:800;font-size:1.1rem;line-height:1.2;}
    .repo-f-desc{font-size:.83rem;color:var(--muted);line-height:1.65;font-weight:300;flex-grow:1;}
    .repo-meta{display:flex;gap:1rem;align-items:center;flex-wrap:wrap;}
    .repo-lang{display:flex;align-items:center;gap:.35rem;font-family:var(--fm);font-size:.68rem;color:var(--muted);}
    .lang-dot{width:8px;height:8px;border-radius:50%;}
    .repo-stat{font-family:var(--fm);font-size:.68rem;color:var(--muted);display:flex;align-items:center;gap:.3rem;}
    .repo-detail-btn{display:inline-flex;align-items:center;gap:.4rem;font-family:var(--fb);font-size:.78rem;font-weight:600;
      color:var(--accent);background:rgba(0,230,200,.08);border:1px solid rgba(0,230,200,.2);
      padding:.45rem 1rem;border-radius:6px;transition:background .2s;margin-top:.2rem;width:fit-content;}
    .repo-detail-btn:hover{background:rgba(0,230,200,.15);}

    /* ALL REPOS ‚Äî compact list */
    .all-repos-list{display:flex;flex-direction:column;gap:.65rem;}
    .repo-row{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1rem 1.25rem;
      display:flex;align-items:center;gap:1.2rem;cursor:pointer;transition:border-color .25s,background .25s;}
    .repo-row:hover{border-color:var(--border-bright);background:rgba(0,230,200,.03);}
    .repo-row-icon{font-size:1.1rem;width:32px;text-align:center;flex-shrink:0;}
    .repo-row-main{flex:1;min-width:0;}
    .repo-row-name{font-family:var(--fd);font-weight:700;font-size:.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .repo-row-desc{font-size:.78rem;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:300;}
    .repo-row-meta{display:flex;gap:.8rem;align-items:center;flex-shrink:0;}
    .repo-row-lang{display:flex;align-items:center;gap:.3rem;font-family:var(--fm);font-size:.65rem;color:var(--muted);}
    .repo-row-stars{font-family:var(--fm);font-size:.65rem;color:var(--muted);}
    .repo-row-date{font-family:var(--fm);font-size:.62rem;color:var(--muted);opacity:.6;}

    /* SKELETON */
    .skeleton{background:linear-gradient(90deg,var(--surface) 25%,rgba(255,255,255,.05) 50%,var(--surface) 75%);
      background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:6px;}
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}

    /* DETAIL MODAL */
    .modal-overlay{position:fixed;inset:0;z-index:500;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);
      display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .3s;}
    .modal-overlay.open{opacity:1;pointer-events:all;}
    .modal{background:#0b1122;border:1px solid rgba(0,230,200,.2);border-radius:20px;max-width:700px;width:100%;
      max-height:90vh;overflow-y:auto;padding:2.5rem;position:relative;
      transform:translateY(20px);transition:transform .3s;}
    .modal-overlay.open .modal{transform:translateY(0);}
    .modal-close{position:absolute;top:1.2rem;right:1.2rem;background:var(--surface);border:1px solid var(--border);
      border-radius:8px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;
      cursor:pointer;color:var(--muted);font-size:1.2rem;transition:color .2s,border-color .2s;}
    .modal-close:hover{color:var(--text);border-color:rgba(255,255,255,.2);}
    .modal-header{margin-bottom:1.5rem;}
    .modal-title{font-family:var(--fd);font-weight:800;font-size:1.5rem;margin-bottom:.5rem;}
    .modal-desc{color:var(--muted);line-height:1.7;font-size:.92rem;font-weight:300;}
    .modal-meta-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin:1.5rem 0;padding:1.25rem;
      background:var(--surface);border:1px solid var(--border);border-radius:12px;}
    .modal-meta-item label{font-family:var(--fm);font-size:.62rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;display:block;margin-bottom:.3rem;}
    .modal-meta-item value{font-family:var(--fd);font-weight:700;font-size:.9rem;}
    .modal-topics{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.5rem;}
    .topic-tag{font-family:var(--fm);font-size:.68rem;color:var(--accent2);background:rgba(79,141,255,.08);
      border:1px solid rgba(79,141,255,.2);padding:.25rem .65rem;border-radius:4px;}
    .modal-readme{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.25rem;
      margin-bottom:1.5rem;font-size:.82rem;color:var(--muted);line-height:1.7;font-weight:300;
      max-height:200px;overflow-y:auto;}
    .modal-readme h3{font-family:var(--fd);color:var(--text);font-size:.95rem;margin-bottom:.5rem;}
    .modal-readme code{font-family:var(--fm);font-size:.75rem;background:rgba(255,255,255,.06);padding:.1rem .35rem;border-radius:3px;color:var(--accent);}
    .modal-btns{display:flex;gap:.75rem;flex-wrap:wrap;}
    .btn-modal-primary{background:var(--accent);color:#000;font-family:var(--fb);font-weight:700;font-size:.82rem;
      padding:.6rem 1.4rem;border-radius:8px;text-decoration:none;display:inline-flex;align-items:center;gap:.4rem;transition:filter .2s;}
    .btn-modal-primary:hover{filter:brightness(1.1);}
    .btn-modal-ghost{background:transparent;color:var(--text);font-family:var(--fb);font-weight:500;font-size:.82rem;
      padding:.6rem 1.2rem;border-radius:8px;text-decoration:none;border:1px solid var(--border);
      display:inline-flex;align-items:center;gap:.4rem;transition:border-color .2s;}
    .btn-modal-ghost:hover{border-color:rgba(255,255,255,.25);}
    .loading-text{font-family:var(--fm);font-size:.75rem;color:var(--muted);text-align:center;padding:1rem;}

    /* FORK BADGE */
    .fork-badge{font-family:var(--fm);font-size:.6rem;color:var(--muted);background:rgba(255,255,255,.04);
      border:1px solid var(--border);padding:.15rem .5rem;border-radius:3px;letter-spacing:.05em;}

    footer{padding:2.5rem 5%;border-top:1px solid var(--border);background:rgba(0,0,0,.5);}
    .footer-inner{max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;}
    .footer-logo{font-family:var(--fm);font-size:.85rem;color:var(--muted);}
    .footer-logo span{color:var(--accent);}
    .footer-links{display:flex;gap:1.5rem;}
    .footer-links a{font-size:.78rem;color:var(--muted);text-decoration:none;font-family:var(--fm);transition:color .2s;}
    .footer-links a:hover{color:var(--text);}
    .footer-copy{font-size:.75rem;color:var(--muted);font-family:var(--fm);}

    @media(max-width:768px){
      .hamburger{display:flex;}
      .nav-links{display:none;}
      .nav-links.open{display:flex;flex-direction:column;position:fixed;top:68px;left:0;right:0;
        background:rgba(5,8,16,.97);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);
        padding:1.5rem 5%;gap:1rem;}
      .section-block{padding:0 5% 40px;}
      .repo-row-meta{display:none;}
      .modal{padding:1.5rem;}
      .modal-meta-grid{grid-template-columns:repeat(2,1fr);}
    }
  </style>
</head>
<body>
<div class="bg-grid"></div>
<div class="bg-glow"></div>

<nav>
  <a href="index.html" class="nav-logo">&lt;GRSM /&gt;</a>
  <div class="nav-links" id="navLinks">
    <a href="index.html">Inicio</a>
    <a href="repos.html" class="active">Repositorios</a>
    <a href="proyectos.html">Proyectos</a>
    <a href="blog.html">Blog</a>
    <a href="timeline.html">Timeline</a>
    <a href="contacto.html" class="nav-cta">Contactar</a>
  </div>
  <button class="hamburger" id="hamburger"><span></span><span></span><span></span></button>
</nav>

<div class="wrapper">
  <div class="page-header">
    <div class="max-w">
      <div class="section-label">// github ¬∑ fluxionics</div>
      <h1 class="page-title">Mis <span>Repositorios</span></h1>
      <p class="page-desc">Todo lo que he construido, experimentado y publicado en GitHub. C√≥digo abierto y en constante evoluci√≥n.</p>
      <div class="stats-bar" id="statsBar">
        <div class="stat-chip skeleton" style="width:120px;height:32px;"></div>
        <div class="stat-chip skeleton" style="width:120px;height:32px;"></div>
        <div class="stat-chip skeleton" style="width:120px;height:32px;"></div>
      </div>
    </div>
  </div>

  <!-- DESTACADOS -->
  <div class="section-block">
    <div class="max-w">
      <div class="block-header">
        <div class="block-title">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          Proyectos Destacados
        </div>
        <a href="https://github.com/Fluxionics" target="_blank" class="block-link">Ver en GitHub ‚Üí</a>
      </div>
      <div class="featured-grid" id="featuredGrid">
        <div class="repo-featured" style="pointer-events:none;"><div class="skeleton" style="height:1.2rem;width:55%;margin-bottom:.8rem;"></div><div class="skeleton" style="height:.8rem;width:90%;margin-bottom:.4rem;"></div><div class="skeleton" style="height:.8rem;width:70%;"></div></div>
        <div class="repo-featured" style="pointer-events:none;"><div class="skeleton" style="height:1.2rem;width:60%;margin-bottom:.8rem;"></div><div class="skeleton" style="height:.8rem;width:85%;margin-bottom:.4rem;"></div><div class="skeleton" style="height:.8rem;width:65%;"></div></div>
        <div class="repo-featured" style="pointer-events:none;"><div class="skeleton" style="height:1.2rem;width:50%;margin-bottom:.8rem;"></div><div class="skeleton" style="height:.8rem;width:80%;margin-bottom:.4rem;"></div><div class="skeleton" style="height:.8rem;width:75%;"></div></div>
      </div>
    </div>
  </div>

  <!-- TODOS -->
  <div class="section-block" style="padding-bottom:100px;">
    <div class="max-w">
      <div class="block-header">
        <div class="block-title">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3h18v18H3zM3 9h18M9 21V9"/></svg>
          Todos los Repositorios
        </div>
        <span id="repoCount" style="font-family:var(--fm);font-size:.72rem;color:var(--muted);"></span>
      </div>
      <div class="all-repos-list" id="allReposList">
        <div class="repo-row" style="pointer-events:none;"><div class="skeleton" style="height:.9rem;width:40%;"></div></div>
        <div class="repo-row" style="pointer-events:none;"><div class="skeleton" style="height:.9rem;width:55%;"></div></div>
        <div class="repo-row" style="pointer-events:none;"><div class="skeleton" style="height:.9rem;width:45%;"></div></div>
        <div class="repo-row" style="pointer-events:none;"><div class="skeleton" style="height:.9rem;width:60%;"></div></div>
      </div>
    </div>
  </div>
</div>

<!-- DETAIL MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal" id="modalContent">
    <button class="modal-close" id="modalClose">‚úï</button>
    <div id="modalBody"><div class="loading-text">Cargando detalles...</div></div>
  </div>
</div>

<footer>
  <div class="footer-inner">
    <div class="footer-logo">&lt;GRSM /&gt; ‚Äî <span>Fluxionics</span></div>
    <div class="footer-links">
      <a href="index.html">Inicio</a><a href="repos.html">Repos</a>
      <a href="proyectos.html">Proyectos</a><a href="blog.html">Blog</a>
      <a href="timeline.html">Timeline</a><a href="contacto.html">Contacto</a>
    </div>
    <div class="footer-copy">¬© 2025 Guillermo Rafael S.M.</div>
  </div>
</footer>

<script>
// ‚îÄ‚îÄ NAV ‚îÄ‚îÄ
const hamburger = document.getElementById('hamburger');
const navLinks = document.getElementById('navLinks');
hamburger.addEventListener('click', () => navLinks.classList.toggle('open'));
document.querySelectorAll('.nav-links a').forEach(a => a.addEventListener('click', () => navLinks.classList.remove('open')));

// ‚îÄ‚îÄ LANG COLORS ‚îÄ‚îÄ
const LC = {JavaScript:'#f7df1e',HTML:'#e34c26',CSS:'#563d7c',Python:'#3572A5',TypeScript:'#3178c6',
             'C++':'#f34b7d',Rust:'#dea584',Go:'#00add8',Java:'#b07219',default:'#8b949e'};

// ‚îÄ‚îÄ FEATURED repos (manual pin list ‚Äî update with your real repo names) ‚îÄ‚îÄ
const PINNED = ['Fluxionics.github.io','FluxiVault','Asistente-Virtual','Paloma-Migajera','FluxiStation'];
const ICONS  = {'Fluxionics.github.io':'üåê','FluxiVault':'üîê','Asistente-Virtual':'ü§ñ','Paloma-Migajera':'üïäÔ∏è','FluxiStation':'üìª'};

let allRepos = [];

// ‚îÄ‚îÄ LOAD ‚îÄ‚îÄ
async function init() {
  try {
    // User info
    const [userRes, reposRes] = await Promise.all([
      fetch('https://api.github.com/users/Fluxionics'),
      fetch('https://api.github.com/users/Fluxionics/repos?per_page=100&sort=updated')
    ]);
    if (!userRes.ok || !reposRes.ok) throw new Error('API');
    const user  = await userRes.json();
    const repos = await reposRes.json();
    allRepos = repos.filter(r => !r.fork);

    // Stats bar
    const totalStars = allRepos.reduce((s,r) => s + r.stargazers_count, 0);
    document.getElementById('statsBar').innerHTML = `
      <div class="stat-chip"><strong>${allRepos.length}</strong>&nbsp;repos</div>
      <div class="stat-chip"><strong>${totalStars}</strong>&nbsp;‚≠ê estrellas</div>
      <div class="stat-chip"><strong>${user.followers || 0}</strong>&nbsp;seguidores</div>
    `;

    renderFeatured(repos);
    renderAll(repos);
  } catch(e) {
    useFallback();
  }
}

function renderFeatured(repos) {
  const featured = PINNED.map(name => repos.find(r => r.name === name)).filter(Boolean);
  // if none of pinned found, use top 5 by stars
  const list = featured.length >= 3 ? featured : repos.filter(r=>!r.fork).sort((a,b)=>b.stargazers_count-a.stargazers_count).slice(0,5);
  document.getElementById('featuredGrid').innerHTML = list.map(r => buildFeaturedCard(r)).join('');
}

function renderAll(repos) {
  const sorted = [...repos].filter(r=>!r.fork).sort((a,b)=>new Date(b.updated_at)-new Date(a.updated_at));
  document.getElementById('repoCount').textContent = `${sorted.length} repositorios`;
  document.getElementById('allReposList').innerHTML = sorted.map(r => buildRowCard(r)).join('');
  // attach clicks
  document.querySelectorAll('[data-repo]').forEach(el => {
    el.addEventListener('click', () => openModal(el.dataset.repo));
  });
}

function buildFeaturedCard(r) {
  const color = LC[r.language]||LC.default;
  const icon  = ICONS[r.name] || 'üì¶';
  const desc  = r.description || 'Sin descripci√≥n disponible.';
  return `
  <div class="repo-featured" data-repo="${r.name}">
    <div class="repo-f-top">
      <div class="repo-f-icon">${icon}</div>
      <span class="repo-f-badge">DESTACADO</span>
    </div>
    <div class="repo-f-name">${r.name}</div>
    <div class="repo-f-desc">${desc.length>110?desc.slice(0,107)+'...':desc}</div>
    <div class="repo-meta">
      ${r.language?`<div class="repo-lang"><div class="lang-dot" style="background:${color}"></div>${r.language}</div>`:''}
      <div class="repo-stat">‚≠ê ${r.stargazers_count}</div>
      <div class="repo-stat">üç¥ ${r.forks_count}</div>
    </div>
    <div class="repo-detail-btn">Ver detalles ‚Üí</div>
  </div>`;
}

function buildRowCard(r) {
  const color = LC[r.language]||LC.default;
  const icon  = ICONS[r.name] || 'üì¶';
  const desc  = r.description || 'Sin descripci√≥n.';
  const date  = new Date(r.updated_at).toLocaleDateString('es-MX',{month:'short',year:'numeric'});
  return `
  <div class="repo-row" data-repo="${r.name}">
    <div class="repo-row-icon">${icon}</div>
    <div class="repo-row-main">
      <div class="repo-row-name">${r.name} ${r.fork?'<span class="fork-badge">fork</span>':''}</div>
      <div class="repo-row-desc">${desc.length>80?desc.slice(0,77)+'...':desc}</div>
    </div>
    <div class="repo-row-meta">
      ${r.language?`<div class="repo-row-lang"><div class="lang-dot" style="background:${color}"></div>${r.language}</div>`:''}
      <div class="repo-row-stars">‚≠ê ${r.stargazers_count}</div>
      <div class="repo-row-date">${date}</div>
    </div>
  </div>`;
}

// ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ
async function openModal(repoName) {
  const overlay = document.getElementById('modalOverlay');
  overlay.classList.add('open');
  document.body.style.overflow = 'hidden';
  document.getElementById('modalBody').innerHTML = '<div class="loading-text">Cargando detalles del repositorio...</div>';

  try {
    const [repoRes, readmeRes] = await Promise.all([
      fetch(`https://api.github.com/repos/Fluxionics/${repoName}`),
      fetch(`https://api.github.com/repos/Fluxionics/${repoName}/readme`)
    ]);
    const repo = await repoRes.json();
    let readmeText = '';
    if (readmeRes.ok) {
      const readmeData = await readmeRes.json();
      try { readmeText = atob(readmeData.content).slice(0,600); } catch(e) {}
    }
    const icon = ICONS[repoName] || 'üì¶';
    const color = LC[repo.language]||LC.default;
    const updated = new Date(repo.updated_at).toLocaleDateString('es-MX',{day:'2-digit',month:'long',year:'numeric'});
    const topics = (repo.topics||[]).slice(0,8);

    document.getElementById('modalBody').innerHTML = `
      <div class="modal-header">
        <div style="display:flex;align-items:center;gap:.8rem;margin-bottom:.75rem;">
          <span style="font-size:2rem;">${icon}</span>
          <div>
            <div class="modal-title">${repo.name}</div>
            ${repo.language?`<div class="repo-lang"><div class="lang-dot" style="background:${color}"></div>${repo.language}</div>`:''}
          </div>
        </div>
        <div class="modal-desc">${repo.description || 'Sin descripci√≥n disponible.'}</div>
      </div>
      <div class="modal-meta-grid">
        <div class="modal-meta-item"><label>Estrellas</label><value>‚≠ê ${repo.stargazers_count}</value></div>
        <div class="modal-meta-item"><label>Forks</label><value>üç¥ ${repo.forks_count}</value></div>
        <div class="modal-meta-item"><label>Issues</label><value>üêõ ${repo.open_issues_count}</value></div>
      </div>
      ${topics.length?`<div class="modal-topics">${topics.map(t=>`<span class="topic-tag">${t}</span>`).join('')}</div>`:''}
      ${readmeText?`<div class="modal-readme"><h3>README</h3><p>${readmeText.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>').replace(/`([^`]+)`/g,'<code>$1</code>')}</p></div>`:''}
      <div style="font-family:var(--fm);font-size:.65rem;color:var(--muted);margin-bottom:1.25rem;">√öltima actualizaci√≥n: ${updated}</div>
      <div class="modal-btns">
        <a href="${repo.html_url}" target="_blank" class="btn-modal-primary">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          Ver en GitHub
        </a>
        ${repo.homepage?`<a href="${repo.homepage}" target="_blank" class="btn-modal-ghost">üåê Ver demo</a>`:''}
        <a href="${repo.html_url}/archive/refs/heads/main.zip" target="_blank" class="btn-modal-ghost">‚¨á Descargar ZIP</a>
      </div>`;
  } catch(e) {
    document.getElementById('modalBody').innerHTML = '<div class="loading-text" style="color:var(--accent3);">No se pudo cargar la informaci√≥n del repositorio.</div>';
  }
}

document.getElementById('modalClose').addEventListener('click', closeModal);
document.getElementById('modalOverlay').addEventListener('click', e => { if(e.target === e.currentTarget) closeModal(); });
document.addEventListener('keydown', e => { if(e.key==='Escape') closeModal(); });
function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

// ‚îÄ‚îÄ FALLBACK ‚îÄ‚îÄ
function useFallback() {
  document.getElementById('statsBar').innerHTML = `
    <div class="stat-chip"><strong>5</strong>&nbsp;repos</div>
    <div class="stat-chip"><strong>‚Äî</strong>&nbsp;estrellas</div>
    <div class="stat-chip" style="cursor:pointer;" onclick="window.open('https://github.com/Fluxionics','_blank')">Ver GitHub ‚Üí</div>`;
  const fallback = [
    {name:'Fluxionics.github.io',description:'Portafolio personal con tema oscuro profesional.',language:'HTML',stargazers_count:0,forks_count:0,updated_at:new Date().toISOString(),html_url:'https://github.com/Fluxionics/Fluxionics.github.io',homepage:'https://fluxionics.github.io',topics:['portfolio','html','css']},
    {name:'FluxiVault',description:'App de escritorio para gesti√≥n segura de contrase√±as.',language:'HTML',stargazers_count:0,forks_count:0,updated_at:new Date().toISOString(),html_url:'https://github.com/Fluxionics/FluxiVault',homepage:'https://Fluxionics.github.io/FluxiVault/',topics:['security','passwords','tool']},
    {name:'Asistente-Virtual',description:'Fluxi ‚Äî asistente virtual sin control parental. v1.0.3',language:'JavaScript',stargazers_count:0,forks_count:0,updated_at:new Date().toISOString(),html_url:'https://github.com/Fluxionics/Asistente-Virtual',homepage:'https://fluxionics.github.io/Asistente-Virtual/',topics:['ai','chatbot','javascript']},
    {name:'FluxiStation',description:'Sistema de streaming de radio. v1.0.0',language:'JavaScript',stargazers_count:0,forks_count:0,updated_at:new Date().toISOString(),html_url:'https://github.com/Fluxionics/FluxiStation',homepage:'',topics:['radio','streaming','audio']},
    {name:'Paloma-Migajera',description:'Videojuego: paloma que reconstruye un pan. En desarrollo.',language:'JavaScript',stargazers_count:0,forks_count:0,updated_at:new Date().toISOString(),html_url:'https://github.com/Fluxionics/Paloma-Migajera',homepage:'https://paloma-migajera.vercel.app/',topics:['game','canvas','javascript']},
  ];
  document.getElementById('featuredGrid').innerHTML = fallback.map(r=>buildFeaturedCard(r)).join('');
  document.getElementById('repoCount').textContent = `${fallback.length} repositorios`;
  document.getElementById('allReposList').innerHTML = fallback.map(r=>buildRowCard(r)).join('');
  document.querySelectorAll('[data-repo]').forEach(el=>el.addEventListener('click',()=>openModal(el.dataset.repo)));
  allRepos = fallback;
}

init();
</script>
</body>
</html>
