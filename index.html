<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECUNDARIA DEL ESTADO ðŸŽ“</title>

    <script>
        const tokenString = localStorage.getItem('content_access_token');
        let accessGranted = false;

        if (tokenString) {
            try {
                const tokenData = JSON.parse(tokenString);
                const currentTime = new Date().getTime();

                // 1. Verifica que el valor sea correcto.
                // 2. Verifica que NO haya expirado (expiry > currentTime).
                if (tokenData.value === 'granted' && tokenData.expiry > currentTime) {
                    accessGranted = true;
                } else {
                    // Si expirÃ³ o es invÃ¡lido, lo borramos.
                    localStorage.removeItem('content_access_token');
                }
            } catch (e) {
                // Error al parsear (token corrupto), lo borramos
                localStorage.removeItem('content_access_token');
            }
        }

        if (!accessGranted) {
            // Si no tiene acceso vÃ¡lido, redirige a la clave
            window.location.replace('Contenido.html');
        }
    </script>
    
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <header>
        <h1>SECUNDARIA DEL ESTADO ðŸŽ“</h1>
        <nav>
            <a href="#" class="nav-link" data-seccion="Todo">Todo (Principal)</a>
            <a href="#" class="nav-link" data-seccion="Shippeos">Shippeos</a>
            <a href="#" class="nav-link" data-seccion="Pareja Oficial">Pareja Oficial</a>
            <a href="#" class="nav-link" data-seccion="Conversaciones">Conversaciones</a>
            <a href="#" class="nav-link" data-seccion="Rumor">Rumores</a>
            <a href="#" class="nav-link" data-seccion="Misterios">Misterios</a>
            <a href="#" class="nav-link" data-seccion="Humor">Humor</a>
            <a href="#" class="nav-link" data-seccion="PolÃ­tica">PolÃ­tica</a>
            
            <a href="politica.html" class="nav-link">PolÃ­tica y Reglas</a>
            <a href="#" class="nav-link" id="link-chat">Chat AnÃ³nimo</a>
            <a href="#" class="nav-link" id="link-subir">Subir</a> 
        </nav>

        <div class="search-bar-container">
            <input type="text" id="search-input" placeholder="Buscar chismes, shippeos, misterios...">
            <button id="search-button">Buscar</button>
        </div>
    </header>

    <main>
        <div id="contenedor-publicaciones">
            </div>
    </main>

    <footer>
        <p>&copy; Plataforma Estudiantil. Todos los derechos reservados.</p>
    </footer>

    <div id="media-modal" class="modal">
        <div class="modal-content-viewer">
            <span class="close-media-modal">&times;</span>
            <div id="media-content-viewer"></div>
            <p id="media-caption"></p>
        </div>
    </div>


    <script src="posts.js"></script> 
    <script src="script.js"></script>
</body>
</html>
